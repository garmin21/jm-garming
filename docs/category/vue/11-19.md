---
title: 11-19 åŠ¨æ€è·¯ç”±
date: "2022-11-19"
categories:
  - VUE
tags:
  - VUE
publish: true
---

## åŠ¨æ€è·¯ç”±

è¯´ä¸€ä»¶å¾ˆè ¢çš„äº‹ï¼Œæˆ‘å¥½ä¹…æ²¡åšè¿‡åŠ¨æ€è·¯ç”±ï¼Œåœ¨å…¬å¸åŠå…¬æ—¶ï¼Œé‡åˆ°åç«¯å·²ç»å¸®æˆ‘å¤„ç†å¥½äº†ä¸€é¢—æ ‘ç»“æ„ç»™æˆ‘çš„æ•°æ®ï¼Œæˆ‘åªéœ€è¦è½¬ä¸º vue-router çš„ç»“æ„å°±è¡Œäº†ï¼Œç»“æœå¼„äº†åŠå¤©ï¼Œå¤´è„‘å‘çƒ­ã€‚ä½†æ˜¯å°±æ˜¯å¼„ä¸å‡ºæ¥ï¼Œè¿™ä¸€è‡³è®©æˆ‘è®¤ä¸ºæˆ‘æ˜¯ä¸æ˜¯ï¼Œsb äº† ğŸ˜­

## æ€»ç»“ä¸‹åŠ¨æ€è·¯ç”±æ˜¯æ€ä¹ˆåšçš„

åŠ¨æ€è·¯ç”±å°±æ˜¯å¾ˆç®€å•çš„ä¸€å¥è¯ï¼Œå°±æ˜¯æŠŠ åç«¯è¿”å›çš„ æ•°æ®ï¼Œå…ˆè½¬æ¢ä¸ºä¸€ä¸ª tree ï¼Œç„¶åï¼Œå†å°† tree ç”Ÿæˆ ä¸€ä¸ªè·¯ç”±çš„ tree, å°±è¿™ä¹ˆç®€å•ï¼Œ
åé¢å°±æ ¹æ®è¿™ä¸ªç”Ÿæˆçš„è·¯ç”±ï¼Œæ¸²æŸ“ èœå•ï¼Œä½ å¯ä»¥ä½¿ç”¨ element-ui è‡ªå¸¦çš„ï¼Œä¹Ÿå¯ä»¥ è‡ªå·±å†™ä¸€ä¸ª é€’å½’ç»„ä»¶ï¼Œ ä½†æ˜¯ä½ çš„æœ¬åœ°ï¼Œæ˜¯è¦æœ‰å¯¹åº”ç»“æ„ çš„.vue æ–‡ä»¶ï¼Œä¸èƒ½å…‰æœ‰ è·³è½¬è·¯å¾„ï¼Œæ²¡æœ‰æ–‡ä»¶

- åœ¨ vue-router 3x ä¸­ä½ å¯ä»¥é€šè¿‡ router.addRoutes() å»æ·»åŠ åˆ° vue-router è·¯ç”±ä¸­å»

```js
export function generateRouters(data) {
  return Array.from(data).map((route) => {
    let _route = {};
    _route.name = route.name;
    _route.path = route.urlAddr;
    _route.icon = route.menuIcon;
    _route.component = () => import(`@/views${route.name}`);

    if (route.children) {
      _route.children = generateRouters(route.children);
    }
    return _route;
  });
}
router.addRoutes(generateRouters(data));
```

- vue-router 4x çš„ç‰ˆæœ¬å°±å»é™¤äº†è¿™ä¸ªæ–¹æ³• ï¼Œåªèƒ½ä¸€ä¸ªä¸€ä¸ªåŠ ï¼Œ é€šè¿‡éå† tree ä¸€ä¸ªä¸€ä¸ªåŠ å…¥

## ç”Ÿæˆæ ‘ç»“æ„çš„æ–¹å¼æœ‰å¾ˆå¤šç§

### 1. filter

```js
function arrToTree(souse) {
  if (!Array.isArray(souse)) {
    return souse;
  }
  // å°†æ ¹èŠ‚ç‚¹0è¿”å›
  return souse.filter((node) => {
    // ä¸æ–­çš„å»å¯»æ‰¾å¯¹åº”çš„ä¸€ä¸ªå­èŠ‚ç‚¹
    const children = souse.filter((item) => {
      return node.id === item.pid;
    });
    // å­èŠ‚ç‚¹æœ‰å€¼çš„è¯ï¼Œå°±ç›´æ¥ è®¾ç½® children ä¸ºæ‰¾åˆ°çš„ children
    if (children.length) {
      node.children = children;
    }
    return node.pid === 0;
  });
}
```

### 2. å»ºç«‹ ID æ˜ å°„ å…³ç³»

```js
function invertTrees(sourceArr) {
  let obj = {}; //Â å»ºç«‹idÂ å’Œå¯¹è±¡çš„å…³ç³»
  sourceArr.forEach((item) => (obj[item.id] = item));

  const result = [];
  sourceArr.forEach((node) => {
    //Â æ ¹èŠ‚ç‚¹
    if (node.pid === 0) {
      return result.push(node);
    }

    //Â objé‡Œé¢ pid å»æ‰¾ id
    obj[node.pid].children = obj[node.pid].children || [];
    // è¿™ä¸ªæ—¶å€™ node.pid å’Œ obj[id] æ˜¯ä¸€æ ·çš„ï¼Œ è¿™ä¸ªæ—¶å€™ï¼Œå°±æ˜¯å®ƒçš„å­é›†
    obj[node.pid].children.push(node);
  });

  return result;
}
```

### 3. æ¢äº†ç§å†™å‘ ä¸ 2 åŒæ ·çš„æ€è·¯

```js
function convert(list) {
  const result = [];
  const map = list.reduce((pre, cur) => {
    pre[cur.id] = cur;
    return pre;
  }, {});

  for (let item of list) {
    if (item.pid === 0) {
      result.push(item);
      continue;
    }
    if (item.pid in map) {
      // id å¤„ç†æˆå¯¹è±¡åï¼Œpai å¯¹åº”äº† id
      const parent = map[item.pid];
      parent.children = parent.children || [];
      parent.children.push(item);
    }
  }

  return result;
}
```

### 4. map çš„æ–¹å¼ ä»£æ›¿ object

```js
// key ç›¸åŒ ï¼Œåé¢çš„ä¼šè¦†ç›–å‰é¢çš„
function mapConvert(list) {
  const result = [];
  // å¤§æ•°æ®æƒ…å†µä¸‹ï¼Œè¿™è¾¹ä¼šæŸ¥æ‰¾æ›´å¿«ï¼Œæ•°ç»„çš„æ•ˆç‡ä¼šæ¯”è¾ƒæ…¢
  const map = new Map();
  list.forEach((item) => {
    map.set(item.id, item);
  });

  for (const item of list) {
    if (item.pid === 0) {
      result.push(item);
      continue;
    }
    if (map.has(item.pid)) {
      const parent = map.get(item.pid);

      parent.children = parent.children || [];

      parent.children.push(item);
    }
  }

  return result;
}
```

## å¦‚ä½•å°† tree è½¬ ä¸º arr ?

```js
function treeToArr(data) {
  // reduce ä¸æ–­çš„å»åˆå¹¶ ä¸€ä¸ªå¯¹å¯¹è±¡
  return data.reduce((pre, cur) => {
    const { id, value, pid, children = [] } = cur;
    // concat å¯ä»¥åˆå¹¶å¤šä¸ªï¼Œ
    return pre.concat([{ id, value, pid }], treeToArr(children));
  }, []);
}
```

---

æœ€åï¼Œä¸€ä»¶äº‹ï¼Œå°±æ˜¯å‘Šè¯«ä¸‹è‡ªå·±ï¼Œåšäº‹ä¸€å®šè¦è¸å®
