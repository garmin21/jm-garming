---
title: 3-9 Formily2.0 å®è·µ è‡ªå®šä¹‰ç»„ä»¶
date: '2023-03-09'
categories:
    - æ¡†æ¶
tags:
    - formilyjs
publish: true
---

## ç®€ä»‹

Formily æ˜¯ä¸€ä¸ªä¸æ¡†æ¶æ— å…³çš„è¡¨å•è§£å†³æ–¹æ¡ˆï¼Œä½¿ç”¨äº† JSON Schemaï¼Œå¤šç«¯é€‚é…,ç›®å‰ç¤¾åŒºå·²ç»æœ‰ Reactã€Vue æ–¹æ¡ˆï¼Œæ›´æ˜¯æ”¯æŒäº†ä¼—å¤šæµè¡Œå‰ç«¯æ¡†æ¶å¦‚ antã€nextã€elementã€element-plusã€antdvã€vantã€semiã€tdesign-react ç­‰ã€‚æŒ‰ç…§ä½œè€…çš„è¯´æ³•æ˜¯ï¼šå®šä½æ˜¯ é¢å‘å¤æ‚åœºæ™¯çš„è¡¨å•è§£å†³æ–¹æ¡ˆï¼Œ é¢å‘ä¼ä¸šçº§è¡¨å•çš„ä¸“ä¸šè§£å†³æ–¹æ¡ˆ

## æ¡ˆåˆ—, Button ç»„ä»¶

```tsx
import React from 'react'
import { createBehavior, createResource } from '@designable/core'
import { DnFC } from '@designable/react'
import { createVoidFieldSchema } from '../Field'
import { Button as AntdButton } from 'antd'

// å¯¹antd Button ç»„ä»¶å°è£…ä¸€å±‚ åœ¨æš´éœ² ä½¿ç”¨
export const Button: DnFC<React.ComponentProps<typeof AntdButton>> = (
    props
) => {
    console.log(props, 'ä¼ é€’ä¸‹æ¥çš„props')
    return <AntdButton {...props}>{props.children}</AntdButton>
}

// åˆ›å»ºç»„ä»¶çš„è¡Œä¸ºï¼Œlocals ä¿¡æ¯ã€propsSchema å¯ä¿®æ”¹å±æ€§
Button.Behavior = createBehavior({
    name: 'Button',
    selector: (node) => node.props?.['x-component'] === 'Button', // é€‰æ‹©å™¨
    designerProps: {
        droppable: true, // æ˜¯å¦å¯ä»¥åŒ…å«å…¶ä»–å…ƒç´ 
        // å³ä¾§ä¾§è¾¹æ ç»„ä»¶çš„å±æ€§é…ç½®
        propsSchema: createVoidFieldSchema({
            type: 'object',
            properties: {
                type: {
                    type: 'string',
                    enum: ['primary', 'dashed', 'text', 'link', false],
                    'x-decorator': 'FormItem',
                    'x-component': 'Select',
                    'x-component-props': {
                        defaultValue: false,
                    },
                },
            },
        }),
    },
    // å®šä¹‰å›½é™…åŒ–å†…å®¹
    designerLocales: {
        'zh-CN': {
            title: 'æŒ‰é’®',
            settings: {
                'x-component-props': {
                    type: 'è®¾ç½®æŒ‰é’®ç±»å‹',
                },
            },
        },
        'en-US': {
            title: 'Button',
            settings: {
                'x-component-props': {
                    type: 'Set Button type',
                },
            },
        },
    },
})
// åˆ›å»ºèµ„æºåŸºç¡€ä¿¡æ¯ï¼Œç”¨äºå·¦ä¾§æ‹–æ‹½ç»„ä»¶
Button.Resource = createResource({
    icon: <i>ğŸ˜€</i>, // å›¾æ ‡
    elements: [
        {
            componentName: 'Field',
            props: {
                type: 'void', // void ä»£è¡¨æ˜¯ä¸€ä¸ªç©ºå…ƒç´ 
                'x-component': 'Button', // æŒ‡å®šæ¸²æŸ“çš„ç»„ä»¶ä¸º Button
            },
        },
    ],
})
```

## designerProps æœ‰é‚£äº›å±æ€§

```ts
export interface IDesignerProps {
    package?: string
    registry?: string
    version?: string
    path?: string
    title?: string
    description?: string
    icon?: string
    droppable?: boolean // æ˜¯å¦å¯ä»¥åŒ…å«å…¶ä»–ç»„ä»¶
    draggable?: boolean
    deletable?: boolean
    cloneable?: boolean
    resizable?: IResizable
    translatable?: ITranslate
    inlineChildrenLayout?: boolean
    selfRenderChildren?: boolean
    propsSchema?: ISchema
    defaultProps?: any
    getDragNodes?: (node: TreeNode) => TreeNode | TreeNode[]
    getDropNodes?: (node: TreeNode, parent: TreeNode) => TreeNode | TreeNode[]
    getComponentProps?: (node: TreeNode) => any
    allowAppend?: (target: TreeNode, sources?: TreeNode[]) => boolean
    allowSiblings?: (target: TreeNode, sources?: TreeNode[]) => boolean
    allowDrop?: (target: TreeNode) => boolean
    [key: string]: any
}
```

## é‡åˆ°çš„é—®é¢˜

1. `Warning: <Text /> is using incorrect casing. Use PascalCase for React components, or lowercase for HTML elements.`

æŠ¥è¿™ä¸ªé”™çš„åŸå› ï¼Œæ˜¯ä½ å¯èƒ½åœ¨é¢„è§ˆç»„ä»¶ï¼Œä¸­æ²¡æœ‰å»å¼•å…¥è¿™ä¸ªç»„ä»¶ï¼Œå¯¼è‡´çš„æŠ¥é”™

è§£å†³ï¼š `import { Text } from 'xxxx` åœ¨æ”¾åˆ°è§†å›¾ä¸­å»ä½¿ç”¨

## å‚è€ƒæ–‡ç« 

-   <a target="_blank" href="https://formilyjs.org/">Formily å®˜ç½‘ï¼šhttps://formilyjs.org/</a>
-   <a target="_blank" href="https://blog.csdn.net/React_Community/article/details/127505825">https://blog.csdn.net/React_Community/article/details/127505825</a>
